"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4733],{2435:function(e,r,s){s.d(r,{Z:function(){return n},n:function(){return i}});var t=s(7294),a=s(9101);function n(){return(0,t.useEffect)(()=>{(()=>{try{let e="vjXyYpLgDibpvaLPL";e?(a.default.init(e),console.log("✅ EmailJS initialized successfully with User ID:",e)):console.error("❌ EmailJS User ID not configured")}catch(e){console.error("❌ EmailJS initialization failed:",e)}})()},[]),null}let i=async e=>{try{let r="service_6p2szkk",s="template_h0ekplo",t="vjXyYpLgDibpvaLPL";if(console.log("=== CLIENT-SIDE EMAIL SENDING ==="),console.log("Service ID:",r),console.log("Template ID:",s),console.log("User ID:",t),console.log("Template params:",e),!r||!s||!t)throw Error("EmailJS configuration missing");try{a.default.init(t),console.log("EmailJS re-initialized with User ID:",t)}catch(e){throw console.error("EmailJS initialization error:",e),Error("EmailJS initialization failed: ".concat(e.message))}let n=await a.default.send(r,s,e);return console.log("✅ Email sent successfully:",n),{success:!0,result:n}}catch(r){console.error("❌ Client email error:",r);let e=r.message;return r.message.includes("user ID is required")?e="EmailJS User ID configuration issue. Please check your EmailJS dashboard integration settings.":r.message.includes("service")?e="EmailJS Service configuration issue. Please verify your service is active.":r.message.includes("template")&&(e="EmailJS Template configuration issue. Please verify your template exists and is published."),{success:!1,error:e,originalError:r.message}}}},4733:function(e,r,s){s.d(r,{Z:function(){return f}});var t=s(5893),a=s(7294),n=s(1163),i=s(1046),l=s(1164),o=s(2089),c=s(8361),m=s(2553),d=s(775),u=s(2190),h=s(8497),x=s(9200),p=s(1707);function g(){let[e,r]=(0,a.useState)(!1),[s,n]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let e="https://qyhdzjzvkggcsuhnenaz.supabase.co",s=e&&e.includes("supabase.co")&&e.startsWith("https://");n(s),r(!s)},[]),!e||s)?null:(0,t.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(x.Z,{className:"h-5 w-5 text-yellow-400"})}),(0,t.jsxs)("div",{className:"ml-3 flex-1",children:[(0,t.jsxs)("p",{className:"text-sm text-yellow-700",children:[(0,t.jsx)("strong",{children:"Supabase not configured:"})," Please set up your environment variables in .env.local"]}),(0,t.jsx)("div",{className:"mt-2 text-sm text-yellow-600",children:(0,t.jsxs)("ol",{className:"list-decimal list-inside space-y-1",children:[(0,t.jsxs)("li",{children:["Create a free Supabase project at ",(0,t.jsx)("a",{href:"https://supabase.com",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-yellow-800",children:"supabase.com"})]}),(0,t.jsx)("li",{children:"Copy your project URL and anon key"}),(0,t.jsxs)("li",{children:["Update the values in ",(0,t.jsx)("code",{className:"bg-yellow-100 px-1 rounded",children:".env.local"})]}),(0,t.jsx)("li",{children:"Restart the development server"})]})}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsxs)("a",{href:"/setup",className:"inline-flex items-center text-sm text-yellow-700 hover:text-yellow-800 underline",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 mr-1"}),"View Setup Guide"]})})]}),(0,t.jsx)("div",{className:"ml-auto pl-3",children:(0,t.jsx)("div",{className:"-mx-1.5 -my-1.5",children:(0,t.jsxs)("button",{onClick:()=>r(!1),className:"inline-flex rounded-md bg-yellow-50 p-1.5 text-yellow-500 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:ring-offset-2 focus:ring-offset-yellow-50",children:[(0,t.jsx)("span",{className:"sr-only",children:"Dismiss"}),(0,t.jsx)(u.Z,{className:"h-5 w-5"})]})})})]})})}var y=s(2435),b=s(6501);function f(e){var r,s;let{children:x,requireAuth:p=!1}=e,[f,v]=(0,a.useState)(null),[j,N]=(0,a.useState)(!0),[w,C]=(0,a.useState)(!1),[S,k]=(0,a.useState)(!1),E=(0,n.useRouter)();(0,a.useEffect)(()=>{if(I(),i.OQ){let{data:{subscription:e}}=i.OQ.auth.onAuthStateChange(async(e,r)=>{var s;console.log("\uD83D\uDD04 Auth state change:",e,null==r?void 0:null===(s=r.user)||void 0===s?void 0:s.email),"SIGNED_IN"===e?(v((null==r?void 0:r.user)||null),(null==r?void 0:r.user)&&k(await (0,l.Cn)(r.user.id,r.user.email))):"SIGNED_OUT"===e&&(v(null),k(!1),E.push("/")),N(!1)});return()=>null==e?void 0:e.unsubscribe()}N(!1)},[]);let I=async()=>{try{if(i.OQ){let e=await (0,i.ts)();if(v(e),e){let r=await (0,l.Cn)(e.id,e.email);k(r)}else k(!1)}else v(null),k(!1)}catch(e){console.error("Error checking user:",e)}finally{N(!1)}},D=()=>{S?E.push("/admin"):E.push("/dashboard")},Z=()=>{S?E.push("/admin/upload"):E.push("/sections/1")},J=()=>{S?E.push("/admin/agreements"):E.push("/agreement")},L=()=>{S?E.push("/admin/sermons"):E.push("/sermons")},A=async()=>{try{i.OQ?await (0,i.w7)():v(null),b.default.success("Signed out successfully"),E.push("/")}catch(e){b.default.error("Error signing out")}};if((0,a.useEffect)(()=>{j||!p||f||E.push("/auth/login")},[j,p,f,E]),j)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)("div",{className:"loading-spinner"})});if(p&&!f)return null;let O=E.pathname.startsWith("/auth/"),U=f&&!O;return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(y.Z,{}),(0,t.jsxs)("nav",{className:"bg-white shadow-lg border-b border-gray-200",children:[(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("div",{className:"flex-shrink-0 flex items-center",children:[(0,t.jsx)(o.Z,{className:"h-6 w-6 sm:h-8 sm:w-8 text-church-primary"}),(0,t.jsx)("span",{className:"ml-2 text-lg sm:text-xl font-bold text-gray-900",children:"NBCC LMS"})]}),U&&(0,t.jsxs)("div",{className:"hidden md:ml-6 md:flex md:space-x-8",children:[(0,t.jsxs)("button",{onClick:D,className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat("/dashboard"===E.pathname||"/admin"===E.pathname?"border-church-primary text-church-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,t.jsx)(c.Z,{className:"h-4 w-4 mr-1"}),"Dashboard"]}),(0,t.jsxs)("button",{onClick:Z,className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(E.pathname.startsWith("/sections")||"/admin/upload"===E.pathname?"border-church-primary text-church-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-1"}),"Study Materials"]}),(0,t.jsxs)("button",{onClick:L,className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(E.pathname.startsWith("/sermons")||E.pathname.startsWith("/admin/sermons")?"border-church-primary text-church-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-1"}),"Sermons"]}),(0,t.jsxs)("button",{onClick:J,className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat("/agreement"===E.pathname||E.pathname.startsWith("/admin/agreements")?"border-church-primary text-church-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 mr-1"}),"Agreement"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[U?(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{className:"hidden md:block text-sm text-gray-700",children:["Welcome, ",(null===(r=f.user_metadata)||void 0===r?void 0:r.full_name)||f.email]}),(0,t.jsxs)("button",{onClick:A,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-church-primary hover:bg-church-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-church-primary",children:[(0,t.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"Sign Out"]})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("button",{onClick:()=>E.push("/auth/login"),className:"text-gray-500 hover:text-gray-700 px-3 py-2 rounded-md text-sm font-medium",children:"Sign In"}),(0,t.jsx)("button",{onClick:()=>E.push("/auth/register"),className:"bg-church-primary hover:bg-church-secondary text-white px-4 py-2 rounded-md text-sm font-medium",children:"Register"})]}),U&&(0,t.jsx)("div",{className:"md:hidden ml-4",children:(0,t.jsx)("button",{onClick:()=>C(!w),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",children:w?(0,t.jsx)(u.Z,{className:"h-6 w-6"}):(0,t.jsx)(h.Z,{className:"h-6 w-6"})})})]})]})}),U&&w&&(0,t.jsxs)("div",{className:"md:hidden",children:[f&&(0,t.jsx)("div",{className:"pt-4 pb-3 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"px-4",children:[(0,t.jsx)("div",{className:"text-base font-medium text-gray-800 truncate",children:(null===(s=f.user_metadata)||void 0===s?void 0:s.full_name)||"User"}),(0,t.jsx)("div",{className:"text-sm font-medium text-gray-500 truncate",children:f.email})]})}),(0,t.jsxs)("div",{className:"pt-2 pb-3 space-y-1",children:[(0,t.jsxs)("button",{onClick:()=>{D(),C(!1)},className:"block pl-3 pr-4 py-4 border-l-4 text-base font-medium w-full text-left min-h-[44px] transition-colors duration-200 ".concat("/dashboard"===E.pathname||"/admin"===E.pathname?"border-church-primary text-church-primary bg-church-primary bg-opacity-10":"border-transparent text-gray-600 hover:text-gray-800 hover:bg-gray-50"),children:[(0,t.jsx)(c.Z,{className:"h-5 w-5 inline mr-3"}),"Dashboard"]}),(0,t.jsxs)("button",{onClick:()=>{Z(),C(!1)},className:"block pl-3 pr-4 py-4 border-l-4 text-base font-medium w-full text-left min-h-[44px] transition-colors duration-200 ".concat(E.pathname.startsWith("/sections")||"/admin/upload"===E.pathname?"border-church-primary text-church-primary bg-church-primary bg-opacity-10":"border-transparent text-gray-600 hover:text-gray-800 hover:bg-gray-50"),children:[(0,t.jsx)(o.Z,{className:"h-5 w-5 inline mr-3"}),"Study Materials"]}),(0,t.jsxs)("button",{onClick:()=>{L(),C(!1)},className:"block pl-3 pr-4 py-4 border-l-4 text-base font-medium w-full text-left min-h-[44px] transition-colors duration-200 ".concat(E.pathname.startsWith("/sermons")||E.pathname.startsWith("/admin/sermons")?"border-church-primary text-church-primary bg-church-primary bg-opacity-10":"border-transparent text-gray-600 hover:text-gray-800 hover:bg-gray-50"),children:[(0,t.jsx)(o.Z,{className:"h-5 w-5 inline mr-3"}),"Sermons"]}),(0,t.jsxs)("button",{onClick:()=>{J(),C(!1)},className:"block pl-3 pr-4 py-4 border-l-4 text-base font-medium w-full text-left min-h-[44px] transition-colors duration-200 ".concat("/agreement"===E.pathname||E.pathname.startsWith("/admin/agreements")?"border-church-primary text-church-primary bg-church-primary bg-opacity-10":"border-transparent text-gray-600 hover:text-gray-800 hover:bg-gray-50"),children:[(0,t.jsx)(m.Z,{className:"h-5 w-5 inline mr-3"}),"Agreement"]}),f&&(0,t.jsxs)("button",{onClick:()=>{A(),C(!1)},className:"block pl-3 pr-4 py-4 border-l-4 text-base font-medium w-full text-left min-h-[44px] border-transparent text-red-600 hover:text-red-800 hover:bg-red-50 transition-colors duration-200",children:[(0,t.jsx)(d.Z,{className:"h-5 w-5 inline mr-3"}),"Sign Out"]}),!f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>{E.push("/auth/login"),C(!1)},className:"block pl-3 pr-4 py-4 border-l-4 text-base font-medium w-full text-left min-h-[44px] border-transparent text-gray-600 hover:text-gray-800 hover:bg-gray-50 transition-colors duration-200",children:"Sign In"}),(0,t.jsx)("button",{onClick:()=>{E.push("/auth/register"),C(!1)},className:"block pl-3 pr-4 py-4 border-l-4 text-base font-medium w-full text-left min-h-[44px] border-church-primary text-church-primary bg-church-primary bg-opacity-10 transition-colors duration-200",children:"Register"})]})]})]})]}),(0,t.jsxs)("main",{className:"flex-1",children:[!i.OQ&&(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,t.jsx)(g,{})}),x]}),(0,t.jsx)("footer",{className:"bg-gray-50 border-t border-gray-200 mt-auto",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto py-6 sm:py-8 px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-xs sm:text-sm text-gray-600 mb-2 leading-relaxed",children:"\xa9 2025 New Bridge Community Church Learning Management System"}),(0,t.jsx)("div",{className:"text-xs text-gray-500 leading-relaxed",children:"Built with love for our church community • Powered by faith and technology"})]})})})]})}},1164:function(e,r,s){s.d(r,{Cn:function(){return i},UZ:function(){return n},jW:function(){return l}});var t=s(1046);s(3454);let a=["admin@nbcc.com","pastor@nbcc.com","mppaul1458@gmail.com"],n="NBCC2025ADMIN",i=async(e,r)=>{try{let{data:s,error:n}=await t.OQ.from("users").select("is_admin, role").eq("id",e).single();if(!n&&s&&(!0===s.is_admin||"admin"===s.role))return!0;let i=a.includes(r.toLowerCase())||r.toLowerCase().includes("admin")||r.toLowerCase().includes("pastor");if(i&&e)try{await t.OQ.from("users").upsert({id:e,email:r,is_admin:!0,role:"admin"},{onConflict:"id",ignoreDuplicates:!1}),console.log("Updated admin status in database for:",r)}catch(e){console.warn("Could not update admin status in database:",e.message)}return i}catch(e){return console.warn("Admin status check failed:",e.message),a.includes(r.toLowerCase())||r.toLowerCase().includes("admin")||r.toLowerCase().includes("pastor")}},l=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let{data:{user:n}}=await t.OQ.auth.getUser();if(!n)return e.push("/auth/login"),{isAdmin:!1,user:null};if(!await i(n.id,n.email))return console.log("Access denied for user:",n.email),console.log("Admin emails:",a),(await Promise.resolve().then(s.bind(s,6501))).default.error("Access denied. Admin privileges required. Contact administrator to add ".concat(n.email," to admin list.")),e.push("/dashboard"),{isAdmin:!1,user:n};return r&&r(n),{isAdmin:!0,user:n}}catch(r){return console.error("Error checking admin access:",r),e.push("/auth/login"),{isAdmin:!1,user:null}}finally{n&&n(!1)}}},1046:function(e,r,s){s.d(r,{OQ:function(){return i},ts:function(){return l},w7:function(){return o}});var t=s(8590);let a="https://qyhdzjzvkggcsuhnenaz.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF5aGR6anp2a2dnY3N1aG5lbmF6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk0NjY1NzgsImV4cCI6MjA2NTA0MjU3OH0.wauN1JdrKCl82WFuwtCfq0oZVob8UEE71wjJw6otCFY";console.log("\uD83D\uDD0D Supabase Debug Info:"),console.log("URL:",a),console.log("Key exists:",!!n),console.log("Key length:",n.length),console.log("✅ Is Supabase configured:",!!(a&&n&&a.includes("supabase.co")&&n.length>50));let i=a&&n?(0,t.createClient)(a,n):null;console.log("\uD83D\uDE80 Supabase client created:",!!i);let l=async()=>{if(!i)return console.error("Supabase not configured. Please set up your environment variables in .env.local"),null;let{data:{user:e}}=await i.auth.getUser();return e},o=async()=>{if(!i)return{error:Error("Supabase not configured")};let{error:e}=await i.auth.signOut();return{error:e}}}}]);