(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5270],{8205:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sermons/[id]",function(){return t(5551)}])},5518:function(e,s,t){"use strict";t.d(s,{ax:function(){return n}});var r=t(1046);let n=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let{data:{session:t}}=await r.OQ.auth.getSession();if(!(null==t?void 0:t.access_token))throw Error("No authentication token available");let n={"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),...s.headers};return await fetch(e,{...s,headers:n})}catch(e){throw console.error("Authenticated fetch error:",e),e}}},2761:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3543:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]])},3346:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},493:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1258:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},4307:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},5452:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},8267:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5551:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return g}});var r=t(5893),n=t(7294),a=t(1163),i=t(4733),o=t(1046),l=t(5518),c=t(2761),d=t(3346),u=t(8267),h=t(3543),m=t(5452),x=t(1258),y=t(493),f=t(4307),p=t(6501);function g(){let[e,s]=(0,n.useState)(null),[t,g]=(0,n.useState)(null),[j,b]=(0,n.useState)([]),[w,N]=(0,n.useState)({}),[v,k]=(0,n.useState)(0),[_,S]=(0,n.useState)(!0),[Z,q]=(0,n.useState)(!1),[C,E]=(0,n.useState)(!1),[F,O]=(0,n.useState)(""),[P,A]=(0,n.useState)(!1),T=(0,a.useRouter)(),{id:M}=T.query;(0,n.useEffect)(()=>{M&&H()},[M]);let H=async()=>{try{let e=await (0,o.ts)();if(!e){T.push("/auth/login");return}s(e);let t=await fetch("/api/sermons"),r=await t.json();if(!t.ok)throw Error(r.error||"Failed to load sermon");let n=r.sermons.find(e=>e.id===M);if(!n){p.default.error("Sermon not found"),T.push("/sermons");return}g(n),b(n.sermon_questions||[]);let a=await fetch("/api/sermons/".concat(M,"/responses")),i=await a.json();if(a.ok){let e={};i.responses.forEach(s=>{e[s.question_id]=s.response_text||""}),N(e)}let l=await fetch("/api/sermons/".concat(M,"/participation")),c=await l.json();l.ok&&c.participation&&k(c.participation.current_question_index||0)}catch(e){console.error("Error loading sermon data:",e),p.default.error("Failed to load sermon")}finally{S(!1)}},z=async(e,s)=>{try{q(!0);let t=await (0,l.ax)("/api/sermons/".concat(M,"/responses"),{method:"POST",body:JSON.stringify({question_id:e,response_text:s})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to save response")}await (0,l.ax)("/api/sermons/".concat(M,"/participation"),{method:"POST",body:JSON.stringify({current_question_index:v})})}catch(e){console.error("Error saving response:",e),p.default.error("Failed to save response")}finally{q(!1)}},Q=(e,s)=>{N(t=>({...t,[e]:s}))},B=async()=>{let e=j[v];e&&await z(e.id,w[e.id]||""),v<j.length-1?k(e=>e+1):E(!0)},J=()=>{C?E(!1):v>0&&k(e=>e-1)},L=async()=>{if(!F.trim()){p.default.error("Please enter a question");return}try{A(!0);let e=await (0,l.ax)("/api/sermons/".concat(M,"/public-questions"),{method:"POST",body:JSON.stringify({question_text:F.trim()})});if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to submit question")}p.default.success("Question submitted successfully!"),O(""),await (0,l.ax)("/api/sermons/".concat(M,"/participation"),{method:"POST",body:JSON.stringify({completed:!0})}),T.push("/sermons")}catch(e){console.error("Error submitting question:",e),p.default.error("Failed to submit question")}finally{A(!1)}};if(_)return(0,r.jsx)(i.Z,{requireAuth:!0,children:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"loading-spinner"})})});if(!t)return(0,r.jsx)(i.Z,{requireAuth:!0,children:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Sermon Not Found"}),(0,r.jsx)("button",{onClick:()=>T.push("/sermons"),className:"px-4 py-2 bg-church-primary text-white rounded hover:bg-church-secondary",children:"Back to Sermons"})]})})});let D=j[v],R=(v+(C?1:0))/(j.length+1)*100;return(0,r.jsx)(i.Z,{requireAuth:!0,children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white shadow",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center min-w-0 flex-1",children:[(0,r.jsx)("button",{onClick:()=>T.push("/sermons"),className:"mr-4 p-2 text-gray-400 hover:text-gray-600",children:(0,r.jsx)(c.Z,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("h1",{className:"text-lg sm:text-xl font-bold text-gray-900 truncate",children:t.title}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-4 mt-1 text-sm text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),new Date(t.sermon_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]}),t.pastor_name&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),t.pastor_name]}),t.scripture_reference&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(h.Z,{className:"h-4 w-4 mr-1"}),t.scripture_reference]})]})]})]})}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,r.jsx)("span",{children:"Progress"}),(0,r.jsxs)("span",{children:[Math.round(R),"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-church-primary h-2 rounded-full transition-all duration-300",style:{width:"".concat(R,"%")}})})]})]})}),(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:C?(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)(m.Z,{className:"mx-auto h-12 w-12 text-church-primary mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Questions for the Pastor"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Do you have any questions about today's sermon? Ask freely - your questions will be answered in next week's session."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("textarea",{value:F,onChange:e=>O(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-church-primary focus:border-church-primary",placeholder:"Type your question here... (This will be shared anonymously with the pastor)"}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("button",{onClick:J,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:[(0,r.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,r.jsxs)("div",{className:"space-x-3",children:[(0,r.jsx)("button",{onClick:()=>T.push("/sermons"),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Skip & Finish"}),(0,r.jsx)("button",{onClick:L,disabled:P,className:"inline-flex items-center px-4 py-2 bg-church-primary text-white rounded-md hover:bg-church-secondary disabled:opacity-50",children:P?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"loading-spinner w-4 h-4 mr-2"}),"Submitting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"Submit & Finish"]})})]})]})]})]}):D?(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Question ",v+1," of ",j.length]}),D.is_private&&(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Private Notes"})]}),(0,r.jsx)("p",{className:"text-gray-700 text-lg leading-relaxed",children:D.question_text})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("textarea",{value:w[D.id]||"",onChange:e=>Q(D.id,e.target.value),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-church-primary focus:border-church-primary",placeholder:D.placeholder_text||"Write your thoughts, reflections, or notes here..."}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("button",{onClick:J,disabled:0===v,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,r.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Previous"]}),(0,r.jsx)("button",{onClick:B,disabled:Z,className:"inline-flex items-center px-4 py-2 bg-church-primary text-white rounded-md hover:bg-church-secondary disabled:opacity-50",children:Z?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"loading-spinner w-4 h-4 mr-2"}),"Saving..."]}):(0,r.jsxs)(r.Fragment,{children:[v===j.length-1?"Continue to Q&A":"Next",(0,r.jsx)(f.Z,{className:"h-4 w-4 ml-2"})]})})]})]})]}):(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No questions available for this sermon."})})})]})})}}},function(e){e.O(0,[5285,4733,2888,9774,179],function(){return e(e.s=8205)}),_N_E=e.O()}]);