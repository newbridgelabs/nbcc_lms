(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4405],{4063:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/sermons/[id]/questions",function(){return t(8282)}])},2761:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(3759).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3346:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(3759).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},493:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(3759).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},39:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(3759).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},2779:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(3759).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},5452:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(3759).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},3603:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(3759).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},8267:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(3759).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},8282:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var n=t(5893),r=t(7294),a=t(1163),i=t(4733),l=t(1046),c=t(1164),d=t(2761),o=t(3346),m=t(8267),u=t(2779),x=t(5452),h=t(493),f=t(39),y=t(3603),g=t(6501);function p(){let[e,s]=(0,r.useState)(null),[t,p]=(0,r.useState)(null),[j,w]=(0,r.useState)([]),[N,v]=(0,r.useState)(!0),[b,k]=(0,r.useState)(!1),[_,Z]=(0,r.useState)({}),[q,S]=(0,r.useState)({}),C=(0,a.useRouter)(),{id:E}=C.query;(0,r.useEffect)(()=>{E&&L()},[E]);let L=async()=>{try{let e=await (0,l.ts)();if(!e){C.push("/auth/login");return}if(s(e),!await (0,c.Cn)(e.id,e.email)){C.push("/dashboard");return}k(!0),await R()}catch(e){console.error("Error checking access:",e),g.default.error("Failed to verify access")}finally{v(!1)}},R=async()=>{try{let e=await fetch("/api/sermons"),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to load sermon");let t=s.sermons.find(e=>e.id===E);if(!t){g.default.error("Sermon not found"),C.push("/admin/sermons");return}p(t);let n=await fetch("/api/sermons/".concat(E,"/public-questions")),r=await n.json();if(n.ok){w(r.questions||[]);let e={};r.questions.forEach(s=>{e[s.id]=s.admin_response||""}),Z(e)}}catch(e){console.error("Error loading data:",e),g.default.error("Failed to load questions")}},A=(e,s)=>{Z(t=>({...t,[e]:s}))},U=async function(e,s){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2];try{S(s=>({...s,[e]:!0}));let n=await fetch("/api/sermons/".concat(E,"/public-questions"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({question_id:e,admin_response:s,is_answered:t})});if(!n.ok){let e=await n.json();throw Error(e.error||"Failed to update question")}g.default.success("Response saved successfully!"),await R()}catch(e){console.error("Error updating question:",e),g.default.error("Failed to save response")}finally{S(s=>({...s,[e]:!1}))}},D=e=>new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return N?(0,n.jsx)(i.Z,{requireAuth:!0,children:(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("div",{className:"loading-spinner"})})}):b&&t?(0,n.jsx)(i.Z,{requireAuth:!0,children:(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)("div",{className:"bg-white shadow",children:(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center min-w-0 flex-1",children:[(0,n.jsx)("button",{onClick:()=>C.push("/admin/sermons"),className:"mr-4 p-2 text-gray-400 hover:text-gray-600",children:(0,n.jsx)(d.Z,{className:"h-5 w-5"})}),(0,n.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,n.jsxs)("h1",{className:"text-lg sm:text-xl font-bold text-gray-900 truncate",children:["Q&A: ",t.title]}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-4 mt-1 text-sm text-gray-500",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(o.Z,{className:"h-4 w-4 mr-1"}),new Date(t.sermon_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]}),t.pastor_name&&(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(m.Z,{className:"h-4 w-4 mr-1"}),t.pastor_name]})]})]})]}),j.length>0&&(0,n.jsxs)("button",{onClick:()=>{var e;let s=new Blob([[["Question","Admin Response","Status","Submitted Date"],...j.map(e=>['"'.concat(e.question_text.replace(/"/g,'""'),'"'),'"'.concat((e.admin_response||"").replace(/"/g,'""'),'"'),e.is_answered?"Answered":"Pending",new Date(e.created_at).toLocaleDateString()])].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),n=window.URL.createObjectURL(s),r=document.createElement("a");r.href=n,r.download="sermon-questions-".concat(null==t?void 0:null===(e=t.title)||void 0===e?void 0:e.replace(/[^a-z0-9]/gi,"-").toLowerCase(),".csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)},className:"inline-flex items-center px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-church-primary",children:[(0,n.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})})}),(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,n.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,n.jsx)("div",{className:"p-5",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(x.Z,{className:"h-8 w-8 text-blue-600"})}),(0,n.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Questions"}),(0,n.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:j.length})]})})]})})}),(0,n.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,n.jsx)("div",{className:"p-5",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(h.Z,{className:"h-8 w-8 text-green-600"})}),(0,n.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Answered"}),(0,n.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:j.filter(e=>e.is_answered).length})]})})]})})}),(0,n.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,n.jsx)("div",{className:"p-5",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(f.Z,{className:"h-8 w-8 text-yellow-600"})}),(0,n.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,n.jsxs)("dl",{children:[(0,n.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending"}),(0,n.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:j.filter(e=>!e.is_answered).length})]})})]})})})]}),0===j.length?(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)(x.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,n.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No questions yet"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Questions from congregation members will appear here."})]}):(0,n.jsx)("div",{className:"space-y-6",children:j.map((e,s)=>(0,n.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("span",{className:"inline-flex items-center justify-center h-8 w-8 rounded-full bg-gray-100 text-sm font-medium text-gray-600",children:s+1}),(0,n.jsx)("div",{children:(0,n.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.is_answered?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.is_answered?"Answered":"Pending"})})]}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:D(e.created_at)})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Question:"}),(0,n.jsx)("p",{className:"text-gray-700 bg-gray-50 p-3 rounded-md",children:e.question_text})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-900",children:"Your Response:"}),(0,n.jsx)("textarea",{value:_[e.id]||"",onChange:s=>A(e.id,s.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-church-primary focus:border-church-primary",placeholder:"Type your response to this question..."}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)("button",{onClick:()=>U(e.id,_[e.id]),disabled:q[e.id],className:"inline-flex items-center px-4 py-2 bg-church-primary text-white text-sm font-medium rounded-md hover:bg-church-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-church-primary disabled:opacity-50",children:q[e.id]?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"loading-spinner w-4 h-4 mr-2"}),"Saving..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"Save Response"]})})})]})]},e.id))})]})]})}):null}}},function(e){e.O(0,[5285,4733,2888,9774,179],function(){return e(e.s=4063)}),_N_E=e.O()}]);