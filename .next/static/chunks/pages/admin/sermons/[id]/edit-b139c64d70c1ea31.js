(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9691],{7364:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/sermons/[id]/edit",function(){return t(3673)}])},5518:function(e,r,t){"use strict";t.d(r,{ax:function(){return a}});var s=t(1046);let a=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let{data:{session:t}}=await s.OQ.auth.getSession();if(!(null==t?void 0:t.access_token))throw Error("No authentication token available");let a={"Content-Type":"application/json",Authorization:"Bearer ".concat(t.access_token),...r.headers};return await fetch(e,{...r,headers:a})}catch(e){throw console.error("Authenticated fetch error:",e),e}}},2761:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(3759).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4270:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(3759).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},9819:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(3759).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},7864:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(3759).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},3673:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return p}});var s=t(5893),a=t(7294),n=t(1163),i=t(4733),o=t(1046),c=t(1164),l=t(5518),d=t(2761),u=t(4270),m=t(7864),h=t(9819),x=t(6501);function p(){let[e,r]=(0,a.useState)(null),[t,p]=(0,a.useState)(!0),[f,y]=(0,a.useState)(!1),[b,g]=(0,a.useState)(!1),j=(0,n.useRouter)(),{id:v}=j.query,[N,_]=(0,a.useState)({title:"",description:"",sermon_date:"",pastor_name:"",scripture_reference:"",is_active:!0}),[w,k]=(0,a.useState)([]);(0,a.useEffect)(()=>{v&&q()},[v]);let q=async()=>{try{let e=await (0,o.ts)();if(!e){j.push("/auth/login");return}if(r(e),!await (0,c.Cn)(e.id,e.email)){x.default.error("Admin access required"),j.push("/dashboard");return}g(!0),await C()}catch(e){console.error("Error checking access:",e),x.default.error("Failed to verify access"),j.push("/dashboard")}finally{p(!1)}},C=async()=>{try{let e=await (0,l.ax)("/api/sermons"),r=await e.json();if(!e.ok)throw Error(r.error||"Failed to load sermon");let t=r.sermons.find(e=>e.id===v);if(!t){x.default.error("Sermon not found"),j.push("/admin/sermons");return}_({title:t.title||"",description:t.description||"",sermon_date:t.sermon_date||"",pastor_name:t.pastor_name||"",scripture_reference:t.scripture_reference||"",is_active:t.is_active});let s=t.sermon_questions||[];k(s.map(e=>({id:e.id,question_text:e.question_text,is_private:e.is_private,placeholder_text:e.placeholder_text||"",question_order:e.question_order})))}catch(e){console.error("Error loading sermon data:",e),x.default.error("Failed to load sermon data")}},S=e=>{let{name:r,value:t,type:s,checked:a}=e.target;_(e=>({...e,[r]:"checkbox"===s?a:t}))},E=(e,r,t)=>{k(s=>s.map((s,a)=>a===e?{...s,[r]:t}:s))},Z=e=>{k(r=>r.filter((r,t)=>t!==e))},P=async e=>{if(e.preventDefault(),!N.title.trim()){x.default.error("Please enter a sermon title");return}if(!N.sermon_date){x.default.error("Please select a sermon date");return}let r=w.filter(e=>e.question_text.trim());if(0===r.length){x.default.error("Please add at least one question");return}y(!0);try{let e=await (0,l.ax)("/api/sermons/".concat(v),{method:"PUT",body:JSON.stringify({...N,questions:r.map((e,r)=>({...e,question_order:r+1}))})}),t=await e.json();if(e.ok)x.default.success("Sermon updated successfully!"),j.push("/admin/sermons");else throw Error(t.error||"Failed to update sermon")}catch(e){console.error("Error updating sermon:",e),x.default.error(e.message||"Failed to update sermon")}finally{y(!1)}};return t?(0,s.jsx)(i.Z,{requireAuth:!0,children:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"loading-spinner"})})}):b?(0,s.jsx)(i.Z,{requireAuth:!0,children:(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white shadow",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("button",{onClick:()=>j.push("/admin/sermons"),className:"mr-4 p-2 text-gray-400 hover:text-gray-600",children:(0,s.jsx)(d.Z,{className:"h-5 w-5"})}),(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Edit Sermon"})]})})})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:(0,s.jsxs)("form",{onSubmit:P,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Sermon Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sermon Title *"}),(0,s.jsx)("input",{type:"text",name:"title",value:N.title,onChange:S,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-church-primary focus:border-church-primary",placeholder:"Enter sermon title"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sermon Date *"}),(0,s.jsx)("input",{type:"date",name:"sermon_date",value:N.sermon_date,onChange:S,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-church-primary focus:border-church-primary"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pastor Name"}),(0,s.jsx)("input",{type:"text",name:"pastor_name",value:N.pastor_name,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-church-primary focus:border-church-primary",placeholder:"Enter pastor name"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scripture Reference"}),(0,s.jsx)("input",{type:"text",name:"scripture_reference",value:N.scripture_reference,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-church-primary focus:border-church-primary",placeholder:"e.g., John 3:16, Romans 8:28"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,s.jsx)("textarea",{name:"description",value:N.description,onChange:S,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-church-primary focus:border-church-primary",placeholder:"Brief description of the sermon"})]}),(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",name:"is_active",checked:N.is_active,onChange:S,className:"rounded border-gray-300 text-church-primary focus:ring-church-primary"}),(0,s.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Active (visible to users)"})]})})]})]}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Questions & Outline Points"}),(0,s.jsxs)("button",{type:"button",onClick:()=>{k(e=>[...e,{question_text:"",is_private:!0,placeholder_text:"",question_order:e.length+1}])},className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-church-primary hover:bg-church-secondary",children:[(0,s.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),"Add Question"]})]}),(0,s.jsx)("div",{className:"space-y-4",children:w.map((e,r)=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Question ",r+1]}),w.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>Z(r),className:"text-red-600 hover:text-red-800",children:(0,s.jsx)(m.Z,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),(0,s.jsx)("textarea",{value:e.question_text,onChange:e=>E(r,"question_text",e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-church-primary focus:border-church-primary",placeholder:"Enter your question or outline point"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Placeholder Text (optional)"}),(0,s.jsx)("input",{type:"text",value:e.placeholder_text,onChange:e=>E(r,"placeholder_text",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-church-primary focus:border-church-primary",placeholder:"Helpful hint for users"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:e.is_private,onChange:e=>E(r,"is_private",e.target.checked),className:"rounded border-gray-300 text-church-primary focus:ring-church-primary"}),(0,s.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Private notes (only visible to user)"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.is_private?"Users can take private notes. Only they can see their responses.":"Public Q&A section. Admin can see questions but not who asked them."})]})]})]},r))})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>j.push("/admin/sermons"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:f,className:"inline-flex items-center px-6 py-2 bg-church-primary text-white rounded-md hover:bg-church-secondary disabled:opacity-50",children:f?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Update Sermon"]})})]})]})})]})}):null}}},function(e){e.O(0,[5285,4733,2888,9774,179],function(){return e(e.s=7364)}),_N_E=e.O()}]);