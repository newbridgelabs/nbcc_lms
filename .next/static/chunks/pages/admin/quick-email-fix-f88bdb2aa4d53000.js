(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4879],{5535:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/quick-email-fix",function(){return l(1266)}])},493:function(e,s,l){"use strict";l.d(s,{Z:function(){return a}});let a=(0,l(3759).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9354:function(e,s,l){"use strict";l.d(s,{Z:function(){return a}});let a=(0,l(3759).Z)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},6815:function(e,s,l){"use strict";l.d(s,{Z:function(){return a}});let a=(0,l(3759).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},1266:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return x}});var a=l(5893),r=l(7294),t=l(4733),i=l(1046),n=l(9354),c=l(9200),d=l(6815),o=l(493),m=l(6501);function x(){let[e,s]=(0,r.useState)(!0),[l,x]=(0,r.useState)([]),[h,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{g()},[]);let g=async()=>{try{let{data:e,error:s}=await i.OQ.from("allowed_users").select("*").order("created_at",{ascending:!1});if(s)throw s;x(e||[])}catch(e){console.error("Error loading allowed users:",e),m.default.error("Failed to load allowed users")}finally{s(!1)}},f=async()=>{u(!0);try{console.log("=== FIXING ALEN EMAIL ===");let e=l.find(e=>{var s;return"alenpr76@gmail.com"===e.email||(null===(s=e.full_name)||void 0===s?void 0:s.toLowerCase().includes("alen"))});if(!e)throw Error("Could not find Alen in the allowed users list");console.log("Found Alen user:",e);let{data:s,error:a}=await i.OQ.from("allowed_users").update({email:"alenps76@gmail.com"}).eq("id",e.id).select().single();if(a)throw a;console.log("Updated user:",s),m.default.success("✅ Email fixed! Alen can now register with alenps76@gmail.com"),await g()}catch(e){console.error("Fix error:",e),m.default.error("Failed to fix email: "+e.message)}finally{u(!1)}},j=async()=>{try{console.log("=== TESTING REGISTRATION CHECK ===");let{data:e,error:s}=await i.OQ.from("allowed_users").select("*").eq("email","alenps76@gmail.com").eq("is_used",!1).single();console.log("Registration check result:",{allowedUser:e,allowedError:s}),s||!e?m.default.error("❌ Registration would still fail: "+((null==s?void 0:s.message)||"User not found")):m.default.success("✅ Registration check passed! Alen can now register.")}catch(e){console.error("Test error:",e),m.default.error("Test failed: "+e.message)}};return e?(0,a.jsx)(t.Z,{children:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"loading-spinner"})})}):(0,a.jsx)(t.Z,{requireAuth:!0,children:(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(n.Z,{className:"h-6 w-6 text-blue-600 mr-3"}),(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Quick Email Fix for Alen"})]}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Fix the email address mismatch to allow registration"})]}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Current Allowed Users"}),(0,a.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,a.jsx)("div",{className:"p-3 rounded-lg border ".concat(e.email.includes("alen")?"bg-yellow-50 border-yellow-200":"bg-gray-50 border-gray-200"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.full_name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.email}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["Used: ",e.is_used?"Yes":"No"," | Created: ",new Date(e.created_at).toLocaleDateString()]})]}),e.email.includes("alen")&&(0,a.jsx)("div",{className:"text-yellow-600",children:(0,a.jsx)(c.Z,{className:"h-5 w-5"})})]})},e.id))})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Fix Actions"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-medium text-red-800 mb-2",children:"Problem:"}),(0,a.jsxs)("p",{className:"text-sm text-red-700",children:["Database has: ",(0,a.jsx)("code",{children:"alenpr76@gmail.com"}),(0,a.jsx)("br",{}),"User trying to register with: ",(0,a.jsx)("code",{children:"alenps76@gmail.com"}),(0,a.jsx)("br",{}),'This mismatch causes "contact church administration" error.']})]}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)("button",{onClick:f,disabled:h,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"loading-spinner w-4 h-4 mr-2"}),"Fixing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Fix Email Address"]})}),(0,a.jsxs)("button",{onClick:j,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 flex items-center",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Test Registration Check"]})]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Instructions"}),(0,a.jsx)("div",{className:"space-y-3 text-sm text-gray-600",children:(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-medium text-blue-800 mb-2",children:"Steps to Fix:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-blue-700",children:[(0,a.jsx)("li",{children:'Click "Fix Email Address" to update the database'}),(0,a.jsx)("li",{children:'Click "Test Registration Check" to verify the fix'}),(0,a.jsx)("li",{children:"Ask Alen to try registering again with alenps76@gmail.com"}),(0,a.jsx)("li",{children:"The registration should now work properly"})]})]})})]})]})]})})})})}}},function(e){e.O(0,[5285,4733,2888,9774,179],function(){return e(e.s=5535)}),_N_E=e.O()}]);