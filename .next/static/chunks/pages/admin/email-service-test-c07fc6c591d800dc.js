(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2348],{6705:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/email-service-test",function(){return a(3376)}])},9592:function(e,s,a){"use strict";a.d(s,{j$:function(){return r},u_:function(){return n},vE:function(){return l},zk:function(){return t}});var i=a(1046);let r=async(e,s)=>{try{console.log("Sending Supabase invitation email to:",e);let{data:a,error:r}=await i.OQ.auth.admin.inviteUserByEmail(e,{data:{full_name:s,invited_by:"NBCC Admin",invitation_type:"church_membership"},redirectTo:"".concat(window.location.origin,"/auth/callback?type=invite")});if(r)return console.error("Supabase invitation error:",r),{success:!1,error:r.message};return console.log("Supabase invitation sent successfully:",a),{success:!0,message:"Invitation email sent via Supabase",data:a}}catch(e){return console.error("Supabase email service error:",e),{success:!1,error:e.message}}},t=async e=>{try{console.log("Sending verification email to:",e);let{data:s,error:a}=await i.OQ.auth.resend({type:"signup",email:e,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback")}});if(a)return console.error("Verification email error:",a),{success:!1,error:a.message};return console.log("Verification email sent successfully"),{success:!0,message:"Verification email sent",data:s}}catch(e){return console.error("Verification email service error:",e),{success:!1,error:e.message}}},l=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"notification";try{if(console.log("=== HYBRID EMAIL SERVICE ==="),console.log("Email type:",s),console.log("Recipient:",e.to_email),"invitation"===s){let s=await r(e.to_email,e.to_name);if(s.success)return s;console.warn("Supabase invitation failed, falling back to EmailJS:",s.error)}if("verification"===s){let s=await t(e.to_email);if(s.success)return s;console.warn("Supabase verification failed, falling back to EmailJS:",s.error)}console.log("Using EmailJS fallback...");let i=(await Promise.resolve().then(a.bind(a,9101))).default,l="service_6p2szkk",n="template_h0ekplo",c="vjXyYpLgDibpvaLPL";if(!l||!n||!c)throw Error("EmailJS configuration missing");i.init(c);let o=await i.send(l,n,e);if(200===o.status)return{success:!0,message:"Email sent via EmailJS",service:"emailjs",result:o};throw Error("EmailJS failed with status: ".concat(o.status))}catch(e){return console.error("Hybrid email service error:",e),{success:!1,error:e.message}}},n=async e=>{let s={supabase:{available:!1,error:null},emailjs:{available:!1,error:null}};try{if(i.OQ){let{data:{user:e},error:a}=await i.OQ.auth.getUser();a?s.supabase.error=a.message:s.supabase.available=!0}}catch(e){s.supabase.error=e.message}try{s.emailjs.available=!0}catch(e){s.emailjs.error=e.message}return s}},493:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});let i=(0,a(3759).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6691:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});let i=(0,a(3759).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},3603:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});let i=(0,a(3759).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},9475:function(e,s,a){"use strict";a.d(s,{Z:function(){return i}});let i=(0,a(3759).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},3376:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return g}});var i=a(5893),r=a(7294),t=a(4733),l=a(493),n=a(9475),c=a(9200),o=a(6691);let m=(0,a(3759).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var d=a(3603),u=a(6501),h=a(9592);function g(){let[e,s]=(0,r.useState)(!1),[a,g]=(0,r.useState)("newbridgelabs@gmail.com"),[x,b]=(0,r.useState)(null),[f,p]=(0,r.useState)([]);(0,r.useEffect)(()=>{y()},[]);let y=async()=>{b(await (0,h.u_)(a))},v=e=>{p(s=>[{...e,timestamp:new Date().toISOString()},...s])},j=async()=>{s(!0);try{let e=await (0,h.j$)(a,"Test User");v({type:"Supabase Invitation",success:e.success,message:e.message||e.error,details:e}),e.success?u.default.success("Supabase invitation email sent!"):u.default.error("Supabase invitation failed: "+e.error)}catch(e){v({type:"Supabase Invitation",success:!1,message:e.message,details:{error:e.message}}),u.default.error("Supabase invitation error: "+e.message)}finally{s(!1)}},w=async()=>{s(!0);try{let e=await (0,h.zk)(a);v({type:"Supabase Verification",success:e.success,message:e.message||e.error,details:e}),e.success?u.default.success("Supabase verification email sent!"):u.default.error("Supabase verification failed: "+e.error)}catch(e){v({type:"Supabase Verification",success:!1,message:e.message,details:{error:e.message}}),u.default.error("Supabase verification error: "+e.message)}finally{s(!1)}},N=async()=>{s(!0);try{let e={to_email:a,to_name:"Test User",subject:"Hybrid Email Test",message:"This is a test email from the hybrid email service.",user_os:"Linux 64",user_platform:"Linux",user_browser:"Chrome",user_version:"138.0.0",user_country:"United Kingdom",user_referrer:window.location.href,website_url:window.location.origin},s=await (0,h.vE)(e,"notification");v({type:"Hybrid Email",success:s.success,message:s.message||s.error,details:s}),s.success?u.default.success("Hybrid email sent!"):u.default.error("Hybrid email failed: "+s.error)}catch(e){v({type:"Hybrid Email",success:!1,message:e.message,details:{error:e.message}}),u.default.error("Hybrid email error: "+e.message)}finally{s(!1)}},S=e=>!0===e?(0,i.jsx)(l.Z,{className:"h-4 w-4 text-green-500"}):!1===e?(0,i.jsx)(n.Z,{className:"h-4 w-4 text-red-500"}):(0,i.jsx)(c.Z,{className:"h-4 w-4 text-yellow-500"});return(0,i.jsx)(t.Z,{requireAuth:!0,children:(0,i.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,i.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,i.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,i.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(o.Z,{className:"h-6 w-6 text-blue-600 mr-3"}),(0,i.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Email Service Testing"})]}),(0,i.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Test different email services to find the most reliable option"})]}),(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Test Email Address"}),(0,i.jsx)("input",{type:"email",value:a,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter email to test"})]}),x&&(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Service Status"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,i.jsx)("span",{className:"font-medium",children:"Supabase Email"}),S(x.supabase.available)]}),(0,i.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,i.jsx)("span",{className:"font-medium",children:"EmailJS"}),S(x.emailjs.available)]})]}),(x.supabase.error||x.emailjs.error)&&(0,i.jsxs)("div",{className:"mt-2 text-sm text-red-600",children:[x.supabase.error&&(0,i.jsxs)("p",{children:["Supabase: ",x.supabase.error]}),x.emailjs.error&&(0,i.jsxs)("p",{children:["EmailJS: ",x.emailjs.error]})]})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Email Tests"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,i.jsxs)("button",{onClick:j,disabled:e||!a,className:"bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:[e?(0,i.jsx)("div",{className:"loading-spinner w-4 h-4 mr-2"}):(0,i.jsx)(m,{className:"h-4 w-4 mr-2"}),"Supabase Invitation"]}),(0,i.jsxs)("button",{onClick:w,disabled:e||!a,className:"bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:[e?(0,i.jsx)("div",{className:"loading-spinner w-4 h-4 mr-2"}):(0,i.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Supabase Verification"]}),(0,i.jsxs)("button",{onClick:N,disabled:e||!a,className:"bg-purple-600 text-white px-4 py-3 rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:[e?(0,i.jsx)("div",{className:"loading-spinner w-4 h-4 mr-2"}):(0,i.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Hybrid Email"]})]})]}),f.length>0&&(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Test Results"}),(0,i.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:f.map((e,s)=>(0,i.jsxs)("div",{className:"p-4 rounded-lg border ".concat(e.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsx)("span",{className:"font-medium",children:e.type}),(0,i.jsxs)("div",{className:"flex items-center",children:[S(e.success),(0,i.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:new Date(e.timestamp).toLocaleTimeString()})]})]}),(0,i.jsx)("p",{className:"text-sm ".concat(e.success?"text-green-700":"text-red-700"),children:e.message}),e.details&&(0,i.jsxs)("details",{className:"mt-2",children:[(0,i.jsx)("summary",{className:"text-xs text-gray-500 cursor-pointer",children:"Details"}),(0,i.jsx)("pre",{className:"text-xs text-gray-600 mt-1 whitespace-pre-wrap",children:JSON.stringify(e.details,null,2)})]})]},s))})]}),(0,i.jsxs)("div",{className:"border-t pt-6",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recommendations"}),(0,i.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,i.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,i.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"For Production Use:"}),(0,i.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[(0,i.jsx)("li",{children:"Use Supabase Auth emails for user registration/verification (most reliable)"}),(0,i.jsx)("li",{children:"Configure SMTP in Supabase for custom email templates"}),(0,i.jsx)("li",{children:"Use EmailJS only for non-critical notifications"}),(0,i.jsx)("li",{children:"Consider professional email services (SendGrid, Mailgun) for high volume"})]})]}),(0,i.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,i.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"EmailJS Issues:"}),(0,i.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-yellow-700",children:[(0,i.jsx)("li",{children:"Free tier has limitations and reliability issues"}),(0,i.jsx)("li",{children:"Gmail service often blocks automated emails"}),(0,i.jsx)("li",{children:"Template parameters must match exactly"}),(0,i.jsx)("li",{children:"Better for contact forms than transactional emails"})]})]})]})]})]})]})})})})}}},function(e){e.O(0,[5285,4733,2888,9774,179],function(){return e(e.s=6705)}),_N_E=e.O()}]);