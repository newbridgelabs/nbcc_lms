"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8522],{4563:function(e,t,r){r.d(t,{Z:function(){return a}});var s=r(5893),o=r(493);let n=(0,r(3759).Z)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var l=r(2126);function a(e){let{sections:t=[],currentSection:r=1,completedSections:a=[],onSectionClick:c}=e;console.log("ProgressTracker props:",{sectionsCount:t.length,currentSection:r,completedSections:a,completedSectionsType:typeof a,completedSectionsArray:Array.isArray(a)});let i=Array.isArray(a)?a.filter(e=>"number"==typeof e&&!isNaN(e)):[];console.log("Safe completed sections:",i);let u=e=>i.includes(e)?"completed":e===r?"current":e<r||1===e?"available":"locked",d=e=>{switch(e){case"completed":return(0,s.jsx)(o.Z,{className:"h-6 w-6 text-green-600"});case"current":return(0,s.jsx)(n,{className:"h-6 w-6 text-blue-600 fill-current"});case"available":default:return(0,s.jsx)(n,{className:"h-6 w-6 text-gray-400"});case"locked":return(0,s.jsx)(l.Z,{className:"h-6 w-6 text-gray-300"})}},m=e=>{switch(e){case"completed":return"bg-green-50 border-green-200 text-green-800 cursor-pointer hover:bg-green-100";case"current":return"bg-blue-50 border-blue-200 text-blue-800 cursor-pointer hover:bg-blue-100";case"available":return"bg-gray-50 border-gray-200 text-gray-600 cursor-pointer hover:bg-gray-100";case"locked":return"bg-gray-50 border-gray-200 text-gray-400 cursor-not-allowed";default:return"bg-gray-50 border-gray-200 text-gray-400"}},g=(e,t)=>{"locked"!==t&&c&&c(e)},p=i.length,h=t.length,x=h>0?p/h*100:0;return console.log("Progress calculation:",{completedCount:p,totalSections:h,progressPercentage:Math.round(x)}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,s.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:"Learning Progress"}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 sm:h-3 mb-2",children:(0,s.jsx)("div",{className:"bg-green-600 h-2 sm:h-3 rounded-full transition-all duration-300 ease-in-out",style:{width:"".concat(x,"%")}})}),(0,s.jsxs)("div",{className:"flex justify-between text-xs sm:text-sm text-gray-600",children:[(0,s.jsxs)("span",{children:[p," of ",h," sections completed"]}),(0,s.jsxs)("span",{children:[Math.round(x),"%"]})]})]}),(0,s.jsx)("div",{className:"space-y-2 sm:space-y-3",children:t.map((e,t)=>{let r=t+1,o=u(r);return(0,s.jsxs)("div",{onClick:()=>g(r,o),className:"flex items-center p-3 sm:p-4 rounded-lg border transition-colors duration-200 ".concat(m(o)," min-h-[60px] sm:min-h-[auto]"),children:[(0,s.jsx)("div",{className:"flex-shrink-0 mr-3",children:d(o)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-0",children:[(0,s.jsxs)("h4",{className:"text-sm sm:text-base font-medium truncate",children:["Section ",r]}),(0,s.jsxs)("div",{className:"flex gap-1",children:["current"===o&&(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:"Current"}),"completed"===o&&(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Complete"})]})]}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-gray-500 mt-1 truncate",children:e.title||"Study material section ".concat(r)}),e.pageRange&&(0,s.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Pages ",e.pageRange]})]}),"locked"===o&&(0,s.jsx)("div",{className:"ml-2 text-xs sm:text-sm text-gray-400 text-center sm:text-left",children:"Complete previous sections first"})]},e.id||r)})}),(0,s.jsx)("div",{className:"mt-4 sm:mt-6 pt-4 sm:pt-6 border-t border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center p-3 sm:p-4 rounded-lg border transition-colors duration-200 min-h-[60px] sm:min-h-[auto] ".concat(p===h?"bg-yellow-50 border-yellow-200 text-yellow-800 cursor-pointer hover:bg-yellow-100":"bg-gray-50 border-gray-200 text-gray-400 cursor-not-allowed"),onClick:()=>{p===h&&c&&c("agreement")},children:[(0,s.jsx)("div",{className:"flex-shrink-0 mr-3",children:p===h?(0,s.jsx)(n,{className:"h-6 w-6 text-yellow-600"}):(0,s.jsx)(l.Z,{className:"h-6 w-6 text-gray-300"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-0",children:[(0,s.jsx)("h4",{className:"text-sm sm:text-base font-medium",children:"Membership Agreement"}),p===h&&(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"Available"})]}),(0,s.jsx)("p",{className:"text-xs sm:text-sm mt-1",children:p===h?"Ready to complete your membership":"Complete all sections to unlock"})]})]})})]})}},7298:function(e,t,r){r.d(t,{KO:function(){return a},L$:function(){return i},oN:function(){return n},sN:function(){return o},t7:function(){return l},zy:function(){return c}});var s=r(9495);let o=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;try{let r=await e.arrayBuffer(),o=await s.PDFDocument.load(r),n=o.getPageCount(),l=Math.ceil(n/t),a=[];for(let e=0;e<t;e++){let t=e*l,r=Math.min(t+l-1,n-1);if(t<n){let n=await s.PDFDocument.create();for(let e=t;e<=r;e++){let[t]=await n.copyPages(o,[e]);n.addPage(t)}let l=await n.save();a.push({sectionNumber:e+1,title:"Section ".concat(e+1," (Pages ").concat(t+1,"-").concat(r+1,")"),content:l,pageRange:"".concat(t+1,"-").concat(r+1),totalPages:r-t+1})}}return{sections:a,error:null}}catch(e){return console.error("Error splitting PDF:",e),{sections:null,error:e}}},n=async(e,t)=>{try{console.log("Starting PDF sections upload...");let{data:{session:r}}=await t.auth.getSession();if(!(null==r?void 0:r.access_token))throw Error("No authentication token available");console.log("Session token available, preparing upload...");let s={sections:e.map(t=>({title:t.title,section_number:t.sectionNumber,total_sections:e.length,content:Array.from(new Uint8Array(t.content))}))};console.log("Sending request to upload API...");let o=await fetch("/api/admin/upload-sections",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r.access_token)},body:JSON.stringify(s)});if(console.log("Upload API response status:",o.status),!o.ok){let e="Failed to upload sections";try{let t=await o.json();e=t.error||e,console.error("Upload API error:",t)}catch(r){let t=await o.text();console.error("Upload API returned non-JSON response:",t),e=t.includes("<html>")||t.includes("<!DOCTYPE")?"Server returned HTML instead of JSON. Check server logs for authentication issues.":"Server error: ".concat(o.status," ").concat(o.statusText)}throw Error(e)}let n=await o.json();return console.log("Upload successful:",n),{sections:n.sections,error:null}}catch(e){return console.error("Error uploading sections:",e),{sections:null,error:e}}},l=async e=>{try{if(!e)return{sections:[],error:null};let{data:t,error:r}=await e.from("pdf_sections").select("*").order("section_number");if(r)throw r;return{sections:t,error:null}}catch(e){return{sections:null,error:e}}},a=async(e,t)=>{try{if(console.log("Getting PDF URL for file path:",e),!e)return console.error("No file path provided"),null;let{data:r}=t.storage.from("pdf-sections").getPublicUrl(e);if(console.log("Generated public URL:",null==r?void 0:r.publicUrl),null==r?void 0:r.publicUrl)return console.log("Returning public URL:",r.publicUrl),r.publicUrl;return null}catch(e){return console.error("Error getting PDF URL:",e),null}},c=async(e,t,r)=>{try{if(console.log("Marking section complete:",{userId:e,sectionId:t}),!e||!t)throw Error("User ID and Section ID are required");let r=await fetch("/api/complete-section",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,sectionId:t})}),s=await r.json();if(!r.ok)throw Error(s.error||"Failed to complete section");return console.log("Section marked complete successfully:",s.data),{data:s.data,error:null}}catch(e){return console.error("Error marking section complete:",e),{data:null,error:e}}},i=async(e,t)=>{try{if(!t||!e)return{progress:[],error:null};console.log("Getting user progress for userId:",e);let{data:r,error:s}=await t.from("user_progress").select("\n        *,\n        pdf_sections (\n          id,\n          title,\n          section_number,\n          total_sections\n        )\n      ").eq("user_id",e);if(s)throw console.error("Error fetching user progress:",s),s;console.log("Raw progress data:",r);let o=(null==r?void 0:r.filter(e=>null!==e.pdf_sections))||[];return console.log("Valid progress data:",o),{progress:o,error:null}}catch(e){return console.error("getUserProgress error:",e),{progress:null,error:e}}}},493:function(e,t,r){r.d(t,{Z:function(){return s}});let s=(0,r(3759).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2126:function(e,t,r){r.d(t,{Z:function(){return s}});let s=(0,r(3759).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},4976:function(e,t,r){r.d(t,{Z:function(){return s}});let s=(0,r(3759).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}}]);