"use strict";exports.id=4895,exports.ids=[4895],exports.modules={3454:(e,r,t)=>{t.d(r,{Z:()=>n});var s=t(997),o=t(1020);let l=(0,t(4370).Z)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var a=t(3460);function n({sections:e=[],currentSection:r=1,completedSections:t=[],onSectionClick:n}){console.log("ProgressTracker props:",{sectionsCount:e.length,currentSection:r,completedSections:t,completedSectionsType:typeof t,completedSectionsArray:Array.isArray(t)});let c=Array.isArray(t)?t.filter(e=>"number"==typeof e&&!isNaN(e)):[];console.log("Safe completed sections:",c);let i=e=>c.includes(e)?"completed":e===r?"current":e<r||1===e?"available":"locked",d=e=>{switch(e){case"completed":return s.jsx(o.Z,{className:"h-6 w-6 text-green-600"});case"current":return s.jsx(l,{className:"h-6 w-6 text-blue-600 fill-current"});case"available":default:return s.jsx(l,{className:"h-6 w-6 text-gray-400"});case"locked":return s.jsx(a.Z,{className:"h-6 w-6 text-gray-300"})}},u=e=>{switch(e){case"completed":return"bg-green-50 border-green-200 text-green-800 cursor-pointer hover:bg-green-100";case"current":return"bg-blue-50 border-blue-200 text-blue-800 cursor-pointer hover:bg-blue-100";case"available":return"bg-gray-50 border-gray-200 text-gray-600 cursor-pointer hover:bg-gray-100";case"locked":return"bg-gray-50 border-gray-200 text-gray-400 cursor-not-allowed";default:return"bg-gray-50 border-gray-200 text-gray-400"}},m=(e,r)=>{"locked"!==r&&n&&n(e)},g=c.length,p=e.length,x=p>0?g/p*100:0;return console.log("Progress calculation:",{completedCount:g,totalSections:p,progressPercentage:Math.round(x)}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[(0,s.jsxs)("div",{className:"mb-4 sm:mb-6",children:[s.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:"Learning Progress"}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 sm:h-3 mb-2",children:s.jsx("div",{className:"bg-green-600 h-2 sm:h-3 rounded-full transition-all duration-300 ease-in-out",style:{width:`${x}%`}})}),(0,s.jsxs)("div",{className:"flex justify-between text-xs sm:text-sm text-gray-600",children:[(0,s.jsxs)("span",{children:[g," of ",p," sections completed"]}),(0,s.jsxs)("span",{children:[Math.round(x),"%"]})]})]}),s.jsx("div",{className:"space-y-2 sm:space-y-3",children:e.map((e,r)=>{let t=r+1,o=i(t);return(0,s.jsxs)("div",{onClick:()=>m(t,o),className:`flex items-center p-3 sm:p-4 rounded-lg border transition-colors duration-200 ${u(o)} min-h-[60px] sm:min-h-[auto]`,children:[s.jsx("div",{className:"flex-shrink-0 mr-3",children:d(o)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-0",children:[(0,s.jsxs)("h4",{className:"text-sm sm:text-base font-medium truncate",children:["Section ",t]}),(0,s.jsxs)("div",{className:"flex gap-1",children:["current"===o&&s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:"Current"}),"completed"===o&&s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Complete"})]})]}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1 truncate",children:e.title||`Study material section ${t}`}),e.pageRange&&(0,s.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Pages ",e.pageRange]})]}),"locked"===o&&s.jsx("div",{className:"ml-2 text-xs sm:text-sm text-gray-400 text-center sm:text-left",children:"Complete previous sections first"})]},e.id||t)})}),s.jsx("div",{className:"mt-4 sm:mt-6 pt-4 sm:pt-6 border-t border-gray-200",children:(0,s.jsxs)("div",{className:`flex items-center p-3 sm:p-4 rounded-lg border transition-colors duration-200 min-h-[60px] sm:min-h-[auto] ${g===p?"bg-yellow-50 border-yellow-200 text-yellow-800 cursor-pointer hover:bg-yellow-100":"bg-gray-50 border-gray-200 text-gray-400 cursor-not-allowed"}`,onClick:()=>{g===p&&n&&n("agreement")},children:[s.jsx("div",{className:"flex-shrink-0 mr-3",children:g===p?s.jsx(l,{className:"h-6 w-6 text-yellow-600"}):s.jsx(a.Z,{className:"h-6 w-6 text-gray-300"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-0",children:[s.jsx("h4",{className:"text-sm sm:text-base font-medium",children:"Membership Agreement"}),g===p&&s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"Available"})]}),s.jsx("p",{className:"text-xs sm:text-sm mt-1",children:g===p?"Ready to complete your membership":"Complete all sections to unlock"})]})]})})]})}},8356:(e,r,t)=>{t.d(r,{KO:()=>n,L$:()=>i,oN:()=>l,sN:()=>o,t7:()=>a,zy:()=>c});var s=t(2007);let o=async(e,r=5)=>{try{let t=await e.arrayBuffer(),o=await s.PDFDocument.load(t),l=o.getPageCount(),a=Math.ceil(l/r),n=[];for(let e=0;e<r;e++){let r=e*a,t=Math.min(r+a-1,l-1);if(r<l){let l=await s.PDFDocument.create();for(let e=r;e<=t;e++){let[r]=await l.copyPages(o,[e]);l.addPage(r)}let a=await l.save();n.push({sectionNumber:e+1,title:`Section ${e+1} (Pages ${r+1}-${t+1})`,content:a,pageRange:`${r+1}-${t+1}`,totalPages:t-r+1})}}return{sections:n,error:null}}catch(e){return console.error("Error splitting PDF:",e),{sections:null,error:e}}},l=async(e,r)=>{try{console.log("Starting PDF sections upload...");let{data:{session:t}}=await r.auth.getSession();if(!t?.access_token)throw Error("No authentication token available");console.log("Session token available, preparing upload...");let s={sections:e.map(r=>({title:r.title,section_number:r.sectionNumber,total_sections:e.length,content:Array.from(new Uint8Array(r.content))}))};console.log("Sending request to upload API...");let o=await fetch("/api/admin/upload-sections",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify(s)});if(console.log("Upload API response status:",o.status),!o.ok){let e="Failed to upload sections";try{let r=await o.json();e=r.error||e,console.error("Upload API error:",r)}catch(t){let r=await o.text();console.error("Upload API returned non-JSON response:",r),e=r.includes("<html>")||r.includes("<!DOCTYPE")?"Server returned HTML instead of JSON. Check server logs for authentication issues.":`Server error: ${o.status} ${o.statusText}`}throw Error(e)}let l=await o.json();return console.log("Upload successful:",l),{sections:l.sections,error:null}}catch(e){return console.error("Error uploading sections:",e),{sections:null,error:e}}},a=async e=>{try{if(!e)return{sections:[],error:null};let{data:r,error:t}=await e.from("pdf_sections").select("*").order("section_number");if(t)throw t;return{sections:r,error:null}}catch(e){return{sections:null,error:e}}},n=async(e,r)=>{try{if(console.log("Getting PDF URL for file path:",e),!e)return console.error("No file path provided"),null;let{data:t}=r.storage.from("pdf-sections").getPublicUrl(e);if(console.log("Generated public URL:",t?.publicUrl),t?.publicUrl)return console.log("Returning public URL:",t.publicUrl),t.publicUrl;return null}catch(e){return console.error("Error getting PDF URL:",e),null}},c=async(e,r,t)=>{try{if(console.log("Marking section complete:",{userId:e,sectionId:r}),!e||!r)throw Error("User ID and Section ID are required");let t=await fetch("/api/complete-section",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,sectionId:r})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to complete section");return console.log("Section marked complete successfully:",s.data),{data:s.data,error:null}}catch(e){return console.error("Error marking section complete:",e),{data:null,error:e}}},i=async(e,r)=>{try{if(!r||!e)return{progress:[],error:null};console.log("Getting user progress for userId:",e);let{data:t,error:s}=await r.from("user_progress").select(`
        *,
        pdf_sections (
          id,
          title,
          section_number,
          total_sections
        )
      `).eq("user_id",e);if(s)throw console.error("Error fetching user progress:",s),s;console.log("Raw progress data:",t);let o=t?.filter(e=>null!==e.pdf_sections)||[];return console.log("Valid progress data:",o),{progress:o,error:null}}catch(e){return console.error("getUserProgress error:",e),{progress:null,error:e}}}},1020:(e,r,t)=>{t.d(r,{Z:()=>s});let s=(0,t(4370).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3460:(e,r,t)=>{t.d(r,{Z:()=>s});let s=(0,t(4370).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},220:(e,r,t)=>{t.d(r,{Z:()=>s});let s=(0,t(4370).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}};