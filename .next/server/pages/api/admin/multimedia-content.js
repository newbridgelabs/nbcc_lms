"use strict";(()=>{var e={};e.id=8462,e.ids=[8462],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},6312:(e,t,r)=>{r.r(t),r.d(t,{config:()=>j,default:()=>E,routeModule:()=>P});var n={};r.r(n),r.d(n,{default:()=>l});var o=r(1802),i=r(7153),s=r(6249),a=r(2885);let d=process.env.SUPABASE_SERVICE_ROLE_KEY,u=(0,a.createClient)("https://qyhdzjzvkggcsuhnenaz.supabase.co",d);async function l(e,t){return"GET"===e.method?c(e,t):"POST"===e.method?m(e,t):"PUT"===e.method?f(e,t):"DELETE"===e.method?p(e,t):void(t.setHeader("Allow",["GET","POST","PUT","DELETE"]),t.status(405).json({error:"Method not allowed"}))}async function c(e,t){try{let{section_id:r}=e.query;if(!r)return t.status(400).json({error:"Section ID is required"});let{data:n,error:o}=await u.from("multimedia_content").select("*").eq("section_id",r).eq("is_active",!0).order("display_order",{ascending:!0});if(o)return console.error("Error fetching multimedia content:",o),t.status(500).json({error:"Failed to fetch content"});t.status(200).json({content:n||[]})}catch(e){console.error("Error in GET multimedia content:",e),t.status(500).json({error:"Internal server error"})}}async function m(e,t){try{let{section_id:r,content_type:n,title:o,content_data:i,display_order:s}=e.body;if(console.log("POST request body:",e.body),!r||!n)return t.status(400).json({error:"Section ID and content type are required"});if(!i||"object"!=typeof i)return t.status(400).json({error:"Content data must be a valid object"});if("text"===n&&!i.plain_text)return t.status(400).json({error:"Text content requires plain_text field"});if(["image","video","audio","pdf"].includes(n)&&!i.url)return t.status(400).json({error:`${n} content requires url field`});if("embed"===n&&!i.embed_code)return t.status(400).json({error:"Embed content requires embed_code field"});let a=["text","image","video","audio","pdf","embed"];if(!a.includes(n))return t.status(400).json({error:`Invalid content type. Must be one of: ${a.join(", ")}`});let d=s;if(void 0===d){let{data:e}=await u.from("multimedia_content").select("display_order").eq("section_id",r).order("display_order",{ascending:!1}).limit(1);d=(e?.[0]?.display_order||0)+1}let{data:l,error:c}=await u.from("multimedia_content").insert({section_id:r,content_type:n,title:o,content_data:i,display_order:d}).select().single();if(c)return console.error("Error creating multimedia content:",c),t.status(500).json({error:"Failed to create content"});t.status(201).json({content:l})}catch(e){console.error("Error in POST multimedia content:",e),t.status(500).json({error:"Internal server error"})}}async function f(e,t){try{let{id:r,title:n,content_data:o,display_order:i,is_active:s}=e.body;if(!r)return t.status(400).json({error:"Content ID is required"});let a={};void 0!==n&&(a.title=n),void 0!==o&&(a.content_data=o),void 0!==i&&(a.display_order=i),void 0!==s&&(a.is_active=s);let{data:d,error:l}=await u.from("multimedia_content").update(a).eq("id",r).select().single();if(l)return console.error("Error updating multimedia content:",l),t.status(500).json({error:"Failed to update content"});t.status(200).json({content:d})}catch(e){console.error("Error in PUT multimedia content:",e),t.status(500).json({error:"Internal server error"})}}async function p(e,t){try{let{id:r}=e.query;if(!r)return t.status(400).json({error:"Content ID is required"});let{error:n}=await u.from("multimedia_content").delete().eq("id",r);if(n)return console.error("Error deleting multimedia content:",n),t.status(500).json({error:"Failed to delete content"});t.status(200).json({message:"Content deleted successfully"})}catch(e){console.error("Error in DELETE multimedia content:",e),t.status(500).json({error:"Internal server error"})}}let E=(0,s.l)(n,"default"),j=(0,s.l)(n,"config"),P=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/admin/multimedia-content",pathname:"/api/admin/multimedia-content",bundlePath:"",filename:""},userland:n})},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=t(t.s=6312);module.exports=r})();